<!-- Create New Event Modal -->
<div id="eventModal" class="modal-overlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="eventModalTitle">
    <div class="modal-header">
      <h2 class="modal-title" id="eventModalTitle">Create New Event</h2>
      <a href="#" class="close-btn js-close-modal" aria-label="Close">×</a>
    </div>

    <form action="{{ url_for('create_event') }}" method="POST" enctype="multipart/form-data">
      <input type="hidden" name="source" value="{{ request.endpoint }}">

      <div class="form-row">
        <div class="form-col">
          <div class="form-group">
            <label for="eventName">Event Name</label>
            <input type="text" id="eventName" name="event_name" required />
          </div>

          <div class="form-group">
            <label for="organisingClub">Organising club</label>
            <select id="organisingClub" name="organising_club" required>
              {% if clubs %}
                <option value="" disabled selected>Select club</option>
                {% for ch in clubs %}
                  <option value="{{ ch.club_id }}">{{ ch.club_name }}</option>
                {% endfor %}
              {% else %}
                <option value="" disabled selected>Select club</option>
              {% endif %}
            </select>
          </div>

          <div class="form-group">
            <label for="eventCoordinator">Event Coordinator</label>
            <input type="text" id="eventCoordinator" name="event_coordinator" />
          </div>

          <div class="form-group">
            <label for="venue">Venue</label>
            <input type="text" id="venue" name="venue" />
          </div>
        </div>

        <div class="form-col">
          <!-- Start (date + single 30-min dropdown) -->
          <div class="form-group">
            <label>Start Date &amp; Time</label>
            <div class="form-row">
              <div class="form-col">
                <input type="date" name="start_date" aria-label="Start Date" required>
              </div>
              <div class="form-col">
                <select id="start_time" name="start_time" aria-label="Start Time" required>
                  <option value="">--</option>
                  {% for h in range(0, 24) %}
                    {% for m in [0, 30] %}
                      {% set hour12 = (h % 12) if (h % 12) != 0 else 12 %}
                      {% set ampm   = "AM" if h < 12 else "PM" %}
                      {% set label  = "%02d:%02d %s" % (hour12, m, ampm) %}
                      {% set value  = "%02d:%02d" % (h, m) %}
                      <option value="{{ value }}" {% if start_time == value %}selected{% endif %}>
                        {{ label }}
                      </option>
                    {% endfor %}
                  {% endfor %}
                </select>
              </div>
            </div>
            <div class="input-help">Choose start time (30-minute steps).</div>
          </div>

          <!-- End (date + single 30-min dropdown) -->
          <div class="form-group">
            <label>End Date &amp; Time</label>
            <div class="form-row">
              <div class="form-col">
                <input type="date" name="end_date" aria-label="End Date" required>
              </div>
              <div class="form-col">
                <select id="end_time" name="end_time" aria-label="End Time" required>
                  <option value="">--</option>
                  {% for h in range(0, 24) %}
                    {% for m in [0, 30] %}
                      {% set hour12 = (h % 12) if (h % 12) != 0 else 12 %}
                      {% set ampm   = "AM" if h < 12 else "PM" %}
                      {% set label  = "%02d:%02d %s" % (hour12, m, ampm) %}
                      {% set value  = "%02d:%02d" % (h, m) %}
                      <option value="{{ value }}" {% if end_time == value %}selected{% endif %}>
                        {{ label }}
                      </option>
                    {% endfor %}
                  {% endfor %}
                </select>
              </div>
            </div>
            <div class="input-help">End time must be after start time.</div>
          </div>

          <div class="form-group">
            <label for="eventImage">Event Image</label>
            <div class="file-input-wrapper">
              <input type="file" id="eventImage" name="event_image" class="file-input" accept="image/*" />
              <label for="eventImage" class="file-input-label">Choose File</label>
              <span class="file-name">No file chosen</span>
              <img class="file-preview" alt="Event image preview"
                   style="display:none; max-width:140px; max-height:140px; margin-top:8px; border:1px solid #eee; border-radius:8px;" />
            </div>
            <div class="file-hint">Recommended size: 1200×628 or 800×450</div>
          </div>

          <div class="form-group">
            <label for="maxParticipants">Max Participants</label>
            <input type="number" id="maxParticipants" name="max_participants" min="1" step="1" />
          </div>

          <div class="form-group">
            <label for="status">Status</label>
            <select id="status" name="status">
              <option value="upcoming" selected>Upcoming</option>
              <option value="completed">Completed</option>
              <option value="cancelled">Cancelled</option>
            </select>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="eventDescription">Description</label>
        <textarea id="eventDescription" name="description"></textarea>
      </div>

      <button type="submit" class="submit-btn">Add Event</button>
    </form>
  </div>
</div>
